# Rclone Web GUI - 完整版本

一个功能完整的 Rclone Web 图形化控制界面，支持 rclone 程序的检测、安装、配置和执行。

## 🎯 核心功能

### 1. Rclone 程序管理
- **自动检测** - 检测系统是否已安装 rclone
- **版本显示** - 显示已安装的 rclone 版本号
- **一键安装** - 通过官方脚本自动安装 rclone
- **状态监控** - 实时显示 rclone 运行状态

### 2. 配置文件管理
- **在线编辑** - 直接在 Web 界面编辑 rclone.conf
- **语法验证** - 保存时自动验证配置文件语法
- **配置路径** - 显示配置文件完整路径
- **实时保存** - 支持配置文件的实时保存和加载

### 3. 任务执行与监控
- **命令执行** - 直接输入 rclone 命令并执行
- **进度监控** - 实时显示传输进度、速度和剩余时间
- **任务控制** - 支持任务的启动、暂停和取消
- **历史记录** - 查看所有任务的执行历史

### 4. 文件浏览器
- **双面板布局** - 源和目标文件浏览器
- **文件选择** - 支持多文件选择和批量操作
- **拖拽操作** - 支持文件拖拽到目标位置
- **快捷操作** - 复制、移动、同步等一键操作

## 🏗️ 技术架构

### 前端技术
- **Next.js 15** - React 全栈框架
- **TypeScript** - 类型安全的 JavaScript
- **Tailwind CSS** - 实用优先的 CSS 框架
- **shadcn/ui** - 现代化 UI 组件库
- **Lucide React** - 精美的图标库

### 后端技术
- **Next.js API Routes** - 服务端 API
- **Node.js Child Process** - 系统命令执行
- **文件系统操作** - 配置文件读写
- **实时进度监控** - 任务状态跟踪

### 系统集成
- **rclone 命令行** - 直接调用系统 rclone
- **配置文件管理** - ~/.config/rclone/rclone.conf
- **进程管理** - 任务进程的启动和终止
- **权限处理** - sudo 权限的安装流程

## 📁 项目结构

```
src/
├── app/
│   ├── api/
│   │   └── rclone/
│   │       ├── status/route.ts      # rclone 状态检测
│   │       ├── install/route.ts     # rclone 安装
│   │       ├── config/route.ts      # 配置文件管理
│   │       ├── execute/route.ts     # 命令执行
│   │       └── progress/route.ts    # 进度查询
│   └── page.tsx                     # 主界面
├── components/
│   ├── ui/                          # shadcn/ui 组件
│   └── FileBrowser.tsx              # 文件浏览器组件
└── lib/
    └── socket.ts                    # WebSocket 配置
```

## 🚀 快速开始

### 1. 安装依赖
```bash
npm install
```

### 2. 启动开发服务器
```bash
npm run dev
```

### 3. 访问应用
打开浏览器访问 `http://localhost:3000`

### 4. 首次使用
1. 系统会自动检测 rclone 是否已安装
2. 如果未安装，点击"安装 Rclone"按钮
3. 等待安装完成，版本号会显示在侧边栏
4. 在"配置文件"页面编辑 rclone.conf
5. 在"文件浏览器"或"任务执行"页面开始使用

## 📋 使用指南

### Rclone 安装
- 系统会自动检测常见安装路径
- 支持一键安装最新版本
- 安装过程需要 sudo 权限
- 安装完成后自动显示版本信息

### 配置文件编辑
- 支持在线编辑 rclone.conf
- 提供配置模板和语法提示
- 保存时自动验证配置语法
- 显示配置文件完整路径

### 任务执行
- 支持直接输入 rclone 命令
- 实时显示命令执行进度
- 支持任务的暂停和取消
- 记录完整的任务历史

### 文件操作
- 双面板文件浏览器
- 支持文件和目录的选择
- 一键复制、移动、同步操作
- 实时显示操作进度

## 🔧 API 接口

### 状态检测
```
GET /api/rclone/status
```
返回 rclone 安装状态和版本信息

### 安装 rclone
```
POST /api/rclone/install
```
执行官方安装脚本

### 配置文件管理
```
GET /api/rclone/config    # 获取配置
PUT /api/rclone/config    # 保存配置
```

### 命令执行
```
POST /api/rclone/execute  # 执行命令
DELETE /api/rclone/execute?taskId=xxx  # 取消任务
```

### 进度查询
```
GET /api/rclone/progress?taskId=xxx
```

## 🎨 界面特性

### 响应式设计
- 适配桌面和移动设备
- 自适应布局和字体大小
- 触摸友好的交互设计

### 实时更新
- 任务进度实时刷新
- 状态变化即时显示
- 无需手动刷新页面

### 用户体验
- 直观的操作界面
- 清晰的状态指示
- 友好的错误提示

## 🔒 安全考虑

### 权限管理
- 安装过程需要 sudo 权限
- 配置文件访问权限控制
- 命令执行权限限制

### 输入验证
- 命令参数安全检查
- 配置文件语法验证
- 路径遍历攻击防护

## 🐛 故障排除

### 常见问题
1. **rclone 安装失败** - 检查网络连接和 sudo 权限
2. **配置文件无法保存** - 检查文件权限和磁盘空间
3. **任务执行失败** - 检查 rclone 配置和网络连接
4. **进度显示异常** - 刷新页面或重新启动任务

### 日志查看
- 浏览器开发者工具查看前端日志
- 服务器控制台查看后端日志
- 任务执行历史查看详细错误信息

## 📈 性能优化

### 前端优化
- 组件懒加载
- 状态更新优化
- 内存使用控制

### 后端优化
- 进程池管理
- 缓存机制
- 资源清理

## 🔄 版本更新

### 自动更新
- 支持 rclone 版本检测
- 提供更新提示和下载链接
- 配置文件自动迁移

### 兼容性
- 支持多个 rclone 版本
- 向后兼容配置文件
- 渐进式功能升级

这个项目提供了一个完整的 Rclone Web 管理解决方案，让用户可以通过直观的 Web 界面管理所有的 rclone 操作，无需记忆复杂的命令行参数。